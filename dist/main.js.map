{"version":3,"sources":["webpack://dots/./src/simulator/vector.js","webpack://dots/./src/simulator/particle.js","webpack://dots/./src/interface/presets/star.js","webpack://dots/./src/simulator/interactions.js","webpack://dots/./src/interface/presets/automaton.js","webpack://dots/./src/interface/presets/gas.js","webpack://dots/./src/interface/presets/network.js","webpack://dots/./src/interface/util/particle_actions.js","webpack://dots/./src/interface/ui_builder.js","webpack://dots/./src/interface/intro.js","webpack://dots/./src/entry.js","webpack://dots/./src/simulator/state.js","webpack://dots/./src/interface/client.js","webpack://dots/./src/interface/display.js","webpack://dots/./src/interface/util/color_generators.js"],"names":["Vector","x","y","this","that","scale","magnitude","magnitudeL1","dX","dY","Math","hypot","abs","length","start","end","add","subtract","normalize","random","pos","vel","mass","charge","radius","protected","amount","offset","distSq","size","sqrt","particle","isTouching","source","target","newVelocity","momentum","accelerate","inelasticCollide","grow","delete","absorb","maxAcc","Infinity","G","scalar","min","direction","fakeGravity","sizeMultiplier","move","dist","moveAway","pushConstant","pushAway","particleParams","super","nearby","push","spreadPosition","mouse","spread","paint","stars","gases","automata","networks","dots","shoot","pointer","place","buildButtons","buttonNames","buttonContainerID","i","uiElement","document","createElement","id","innerText","getElementById","appendChild","addClass","className","classList","removeClass","remove","hide","show","fade","sleep","idealSeconds","Promise","resolve","setTimeout","waitForModeSelection","querySelector","addEventListener","waitForOptionSelection","adjustForMobile","window","once","runInSequence","asyncFns","reduce","promise","next","then","simulation","particles","wall","needsCleaning","nParticles","calculateInteractions","updateParticles","walls","cleanup","validParticles","update","j","interact","rightDist","bottomDist","leftDist","topDist","state","mouseHistory","Array","from","pressing","msPerAction","particleType","selectedAction","actions","addEvents","continuousAction","addParticle","option","canvas","onclick","selectAction","ontouchend","selectMode","onmousedown","mouseDown","ontouchstart","onmouseup","mouseUp","onmousemove","mouseMove","passive","e","touches","clientX","clientY","moveTo","innerWidth","innerHeight","clearInterval","asyncActions","setInterval","handleActions","preventDefault","stopPropagation","shift","clickAction","reset","client","ctx","getContext","resize","onresize","width","height","renderParticles","visualSize","fillStyle","dot","star","automaton","gas","beginPath","lineWidth","strokeStyle","fromX","fromY","fillRect","nAdjacentParticles","toX","toY","lineTo","stroke","closePath","displayWidth","displayHeight","clearRect","shadowBlur","shadowColor","globalCompositeOperation","arc","PI","color","alpha","sizeToRGBA","circle","fill","directionToColor","speed","speedToHSL","to","run","render","requestAnimationFrame","introsLeftString","localStorage","getItem","introsLeftNumber","parseInt","setItem","max","toString","introsLeft"],"mappings":"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","file":"main.js","sourcesContent":["class Vector {\n  constructor(x = 0, y = 0) {\n    this.x = x;\n    this.y = y;\n  }\n\n  add(that = new Vector()) {\n    this.x += that.x;\n    this.y += that.y;\n    return this;\n  }\n\n  subtract(that = new Vector()) {\n    this.x -= that.x;\n    this.y -= that.y;\n    return this;\n  }\n\n  scale(that = 1) {\n    this.x *= that;\n    this.y *= that;\n    return this;\n  }\n\n  moveTo(x = 0, y = 0) {\n    this.x = x;\n    this.y = y;\n    return this;\n  }\n\n  normalize() {\n    if (this.x || this.y) {\n      this.scale(1 / this.magnitude());\n    }\n    return this;\n  }\n\n  normalizeL2() {\n    if (this.x || this.y) {\n      this.scale(1 / this.magnitudeL1());\n    }\n    return this;\n  }\n\n  distSq(that = new Vector()) {\n    const dX = this.x - that.x;\n    const dY = this.y - that.y;\n    return dX * dX + dY * dY;\n  }\n\n  dist(that = new Vector()) {\n    const dX = this.x - that.x;\n    const dY = this.y - that.y;\n    return Math.hypot(dX, dY);\n  }\n\n  dot(that = new Vector()) {\n    return this.x * that.x + this.y * that.y;\n  }\n\n  magnitude() {\n    return Math.hypot(this.x, this.y);\n  }\n\n  magnitudeL1() {\n    return Math.abs(this.x) + Math.abs(this.y);\n  }\n\n  static xAxis(length = 1) {\n    return new Vector(length, 0);\n  }\n\n  static yAxis(length = 1) {\n    return new Vector(0, length);\n  }\n\n  static direction(start = new Vector(), end = new Vector()) {\n    return new Vector(0, 0)\n      .add(start)\n      .subtract(end)\n      .normalize();\n  }\n\n  static random(length = 1) {\n    return new Vector(Math.random() - 0.5, Math.random() - 0.5)\n      .normalize()\n      .scale(length);\n  }\n\n  static clone(that = new Vector()) {\n    return new Vector(that.x, that.y);\n  }\n}\n\nexport default Vector;\n","import Vector from './vector';\n\nclass Particle {\n  constructor({\n    pos = new Vector(),\n    vel = new Vector(),\n    mass = 0,\n    charge = 0,\n    radius = 0\n  }) {\n    this.pos = pos;\n    this.vel = vel;\n    this.mass = mass;\n    this.charge = charge;\n    this.radius = radius;\n\n    this.protected = true;\n  }\n\n  momentum() {\n    return Vector.clone(this.vel).scale(this.mass);\n  }\n\n  size() {\n    return this.radius;\n  }\n\n  update() {\n    this.pos.add(this.vel);\n  }\n\n  visualSize(scale) {\n    return this.radius * scale;\n  }\n\n  accelerate(amount = new Vector()) {\n    this.vel.add(amount);\n  }\n\n  move(amount = new Vector()) {\n    this.pos.add(amount);\n  }\n\n  grow(amount = 0) {\n    this.mass += amount;\n  }\n\n  delete() {\n    this.protected = false;\n  }\n\n  isTouching(pos = new Vector(), offset = 0) {\n    return this.pos.distSq(pos) < (this.size() + offset) ** 2;\n  }\n\n  interact() {\n    return null;\n  }\n}\n\nexport default Particle;\n","import Particle from '../../simulator/particle';\nimport {\n  absorb,\n  inelasticCollide,\n  fakeGravity\n} from '../../simulator/interactions';\n\nclass Star extends Particle {\n  visualSize(scale) {\n    return Math.sqrt(this.mass) * scale;\n  }\n\n  size() {\n    return Math.sqrt(this.mass);\n  }\n\n  interact(particle) {\n    const { pos } = particle;\n    const size = particle.size();\n\n    if (this.isTouching(pos, 0.1 * size) && this.protected) {\n      inelasticCollide(this, particle);\n      absorb(this, particle);\n    } else {\n      fakeGravity(this, particle);\n    }\n  }\n}\n\nexport default Star;\n","import Vector from './vector';\nimport Particle from './particle';\n\nexport const absorb = (source = new Particle(), target = new Particle()) => {\n  source.grow(target.mass);\n  target.delete();\n};\n\nexport const inelasticCollide = (\n  source = new Particle(),\n  target = new Particle()\n) => {\n  const newVelocity = source\n    .momentum()\n    .add(target.momentum())\n    .scale(1 / (source.mass + target.mass));\n  source.vel.scale(0);\n  source.accelerate(newVelocity);\n};\n\nexport const moveAway = (\n  source = new Particle(),\n  target = new Particle(),\n  sizeMultiplier = 1\n) => {\n  target.move(\n    Vector.direction(target.pos, source.pos).scale(\n      sizeMultiplier * (source.size() + target.size()) -\n        source.pos.dist(target.pos)\n    )\n  );\n};\n\nexport const fakeGravity = (\n  source = new Particle(),\n  target = new Particle(),\n  maxAcc = Infinity,\n  G = 0.025\n) => {\n  const scalar = Math.min(\n    (G * source.mass) / source.pos.distSq(target.pos),\n    maxAcc\n  );\n  const direction = new Vector(0, 0).add(source.pos).subtract(target.pos);\n\n  target.accelerate(direction.scale(scalar));\n};\n\nexport const pushAway = (\n  source = new Particle(),\n  target = new Particle(),\n  maxAcc = Infinity,\n  pushConstant = 2e-11\n) => {\n  const distSq = source.pos.distSq(target.pos);\n  const scalar = Math.min(pushConstant / (distSq * distSq), maxAcc);\n  const direction = Vector.direction(target.pos, source.pos);\n  target.accelerate(direction.scale(scalar));\n};\n","import Particle from '../../simulator/particle';\nimport { moveAway } from '../../simulator/interactions';\n\nclass Automaton extends Particle {\n  interact(particle) {\n    if (this.isTouching(particle.pos, 1 * this.size() + particle.size())) {\n      moveAway(this, particle, 1.1);\n    }\n  }\n}\n\nexport default Automaton;\n","import Particle from '../../simulator/particle';\nimport { pushAway } from '../../simulator/interactions';\n\nclass Gas extends Particle {\n  size() {\n    return 0.001;\n  }\n\n  interact(particle) {\n    pushAway(this, particle, 0.00025);\n  }\n}\n\nexport default Gas;\n","import Particle from '../../simulator/particle';\n\nclass Network extends Particle {\n  constructor(particleParams) {\n    super(particleParams);\n    this.nearby = [];\n  }\n\n  interact({ pos }) {\n    if (this.isTouching(pos, 0)) this.nearby.push(pos);\n  }\n}\n\nexport default Network;\n","import Vector from '../../simulator/vector';\nimport Star from '../presets/star';\nimport Automaton from '../presets/automaton';\nimport Gas from '../presets/gas';\nimport Network from '../presets/network';\nimport Particle from '../../simulator/particle';\n\nconst spreadPosition = (mouse, spread) =>\n  Vector.random(spread * Math.random()).add(mouse);\n\nconst paint = {\n  stars: mouse =>\n    new Star({\n      mass: 5e-7,\n      vel: Vector.random(0.00001),\n      pos: spreadPosition(mouse, 0.03)\n    }),\n  gases: mouse =>\n    new Gas({\n      radius: 5e-3,\n      vel: Vector.random(0.0001),\n      pos: spreadPosition(mouse, 0.1)\n    }),\n  automata: mouse =>\n    new Automaton({\n      radius: 6e-3,\n      vel: Vector.random(0.001),\n      pos: spreadPosition(mouse, 0.01)\n    }),\n  networks: mouse =>\n    new Network({\n      radius: 1e-1,\n      vel: Vector.random(0.0002),\n      pos: spreadPosition(mouse, 0.15)\n    }),\n  dots: mouse =>\n    new Particle({\n      vel: Vector.random(0.00001),\n      pos: spreadPosition(mouse, 0.03)\n    })\n};\n\nconst shoot = {\n  stars: (mouse, pointer) =>\n    new Star({\n      mass: 3e-6,\n      vel: pointer.scale(0.007),\n      pos: spreadPosition(mouse, 1e-2)\n    }),\n  gases: (mouse, pointer) =>\n    new Gas({\n      radius: 5e-3,\n      vel: pointer.scale(0.006),\n      pos: spreadPosition(mouse, 1e-6)\n    }),\n  automata: (mouse, pointer) =>\n    new Automaton({\n      radius: 6e-3,\n      vel: pointer.scale(0.003),\n      pos: spreadPosition(mouse, 0.01)\n    }),\n  networks: (mouse, pointer) =>\n    new Network({\n      radius: 1e-1,\n      vel: pointer.scale(0.003),\n      pos: spreadPosition(mouse, 0.05)\n    }),\n  dots: (mouse, pointer) =>\n    new Particle({\n      vel: pointer.scale(0.003),\n      pos: spreadPosition(mouse, 1e-2)\n    })\n};\n\nconst place = {\n  stars: mouse =>\n    new Star({\n      mass: 5e-5,\n      vel: new Vector(0, 0),\n      pos: spreadPosition(mouse, 1e-3)\n    }),\n  gases: mouse =>\n    new Gas({\n      vel: new Vector(0, 0),\n      pos: spreadPosition(mouse, 1e-3),\n      radius: 5e-3\n    }),\n  automata: mouse =>\n    new Automaton({\n      radius: 6e-3,\n      vel: new Vector(0, 0),\n      pos: spreadPosition(mouse, 1e-3)\n    }),\n  networks: mouse =>\n    new Network({\n      radius: 1e-1,\n      vel: new Vector(0, 0),\n      pos: spreadPosition(mouse, 1e-3)\n    }),\n  dots: mouse =>\n    new Particle({\n      vel: new Vector(0, 0),\n      pos: spreadPosition(mouse, 5e-3)\n    })\n};\n\nconst actions = {\n  paint,\n  shoot,\n  place\n};\n\nexport default actions;\n","const buildButtons = (buttonNames, buttonContainerID) => {\n  for (let i = 0; i < buttonNames.length; i += 1) {\n    const uiElement = document.createElement('button');\n    uiElement.id = buttonNames[i];\n    uiElement.innerText = buttonNames[i];\n    document.getElementById(buttonContainerID).appendChild(uiElement);\n  }\n};\n\nconst buildInterface = () => {\n  buildButtons(['paint', 'shoot', 'place', 'reset'], 'option-buttons');\n  buildButtons(\n    ['stars', 'gases', 'networks', 'automata'],\n    'particle-type-buttons'\n  );\n};\n\nexport default buildInterface;\n","const introsLeft = () => {\n  const introsLeftString = window.localStorage.getItem('dotsIntros') || '2';\n  const introsLeftNumber = parseInt(introsLeftString, 10);\n  window.localStorage.setItem(\n    'dotsIntros',\n    Math.max(introsLeftNumber - 1, 0).toString()\n  );\n  return introsLeftNumber;\n};\n\nconst addClass = (id, className) => () =>\n  document.getElementById(id).classList.add(className);\n\nconst removeClass = (id, className) => () =>\n  document.getElementById(id).classList.remove(className);\n\nconst hide = id => addClass(id, 'hidden');\nconst show = id => removeClass(id, 'hidden');\nconst fade = id => addClass(id, 'fade-out');\n\nconst sleep = idealSeconds => () =>\n  new Promise(resolve => setTimeout(resolve, idealSeconds * 990));\n\nconst waitForModeSelection = () =>\n  new Promise(resolve => {\n    document.querySelector('.particle-type').addEventListener('click', resolve);\n  });\n\nconst waitForOptionSelection = () =>\n  new Promise(resolve => {\n    document.querySelector('.option').addEventListener('click', resolve);\n  });\n\nconst adjustForMobile = () => {\n  window.addEventListener(\n    'touchstart',\n    () => {\n      addClass('particle-type', 'top-peek')();\n      addClass('option', 'bottom-peek')();\n    },\n    { once: true }\n  );\n};\n\nconst runInSequence = (...asyncFns) =>\n  asyncFns.reduce((promise, next) => promise.then(next), Promise.resolve());\n\nconst welcomeUser = () => {\n  if (introsLeft()) {\n    runInSequence(\n      show('title'),\n      sleep(2),\n      hide('title'),\n      show('select-particle-type'),\n      addClass('particle-type', 'top-peek'),\n      waitForModeSelection,\n      removeClass('particle-type', 'top-peek'),\n      fade('select-particle-type'),\n      sleep(1),\n      hide('select-particle-type'),\n      show('select-option'),\n      addClass('option', 'bottom-peek'),\n      waitForOptionSelection,\n      removeClass('option', 'bottom-peek'),\n      fade('select-option'),\n      sleep(1),\n      hide('select-option'),\n      show('enjoy'),\n      sleep(1),\n      fade('enjoy'),\n      sleep(1),\n      addClass('enjoy', 'hidden'),\n      hide('welcome'),\n      adjustForMobile\n    );\n  } else {\n    runInSequence(show('title'), sleep(2), hide('welcome'), adjustForMobile);\n  }\n};\n\nexport default welcomeUser;\n","import Display from './interface/display';\nimport Client from './interface/client';\nimport State from './simulator/state';\nimport buildInterface from './interface/ui_builder';\nimport welcomeUser from './interface/intro';\n\nbuildInterface();\n\nconst simulation = new State();\nconst client = new Client(simulation);\nconst display = new Display(simulation, client);\n\nfunction run() {\n  display.render();\n  simulation.update();\n  requestAnimationFrame(run);\n}\n\nrequestAnimationFrame(() => {\n  welcomeUser();\n  run();\n});\n","import Vector from './vector';\nimport Particle from './particle';\n\nclass State {\n  constructor(particles = []) {\n    this.particles = particles;\n    this.wall = true;\n    this.needsCleaning = false;\n  }\n\n  update() {\n    const nParticles = this.particles.length;\n\n    this.calculateInteractions(nParticles);\n    this.updateParticles(nParticles);\n\n    if (this.wall) this.walls(nParticles);\n    if (this.needsCleaning) this.cleanup(nParticles);\n  }\n\n  addParticle(particle = new Particle()) {\n    this.particles.push(particle);\n  }\n\n  toggleWalls() {\n    this.wall = !this.wall;\n    return this.wall;\n  }\n\n  cleanup(nParticles = this.particles.length) {\n    let validParticles = 0;\n\n    for (let i = 0; i < nParticles; i += 1) {\n      const particle = this.particles[i];\n\n      if (particle.protected) {\n        if (i !== validParticles) this.particles[validParticles] = particle;\n        validParticles += 1;\n      }\n    }\n    this.particles.length = validParticles;\n  }\n\n  updateParticles(nParticles = this.particles.length) {\n    for (let i = 0; i < nParticles; i += 1) this.particles[i].update();\n  }\n\n  calculateInteractions(nParticles = this.particles.length) {\n    for (let i = 0; i < nParticles; i += 1) {\n      for (let j = 0; j < nParticles; j += 1) {\n        if (i !== j) this.particles[i].interact(this.particles[j]);\n      }\n    }\n  }\n\n  walls(nParticles = this.particles.length) {\n    for (let i = 0; i < nParticles; i += 1) {\n      const { pos, vel } = this.particles[i];\n      const size = this.particles[i].size();\n      const rightDist = 1 - size - pos.x;\n      const bottomDist = 1 - size - pos.y;\n      const leftDist = pos.x - size;\n      const topDist = pos.y - size;\n\n      if (rightDist < 0) {\n        vel.subtract(Vector.xAxis(2 * vel.x));\n        pos.add(Vector.xAxis(rightDist));\n      } else if (leftDist < 0) {\n        vel.subtract(Vector.xAxis(2 * vel.x));\n        pos.subtract(Vector.xAxis(leftDist));\n      } else if (bottomDist < 0) {\n        vel.subtract(Vector.yAxis(2 * vel.y));\n        pos.add(Vector.yAxis(bottomDist));\n      } else if (topDist < 0) {\n        vel.subtract(Vector.yAxis(2 * vel.y));\n        pos.subtract(Vector.yAxis(topDist));\n      }\n    }\n  }\n\n  reset() {\n    this.particles.length = 0;\n  }\n}\n\nexport default State;\n","import Vector from '../simulator/vector';\nimport actions from './util/particle_actions';\n\nclass Client {\n  constructor(state) {\n    this.state = state;\n    this.state.needsCleaning = true;\n\n    this.mouse = new Vector(0, 0);\n    this.mouseHistory = Array.from({ length: 4 }, () => new Vector(0, 0));\n\n    this.pressing = false;\n    this.msPerAction = 30;\n\n    this.particleType = 'stars';\n    this.selectedAction = 'shoot';\n\n    this.actions = actions;\n\n    this.addEvents();\n  }\n\n  get pointer() {\n    return Vector.direction(this.mouse, this.mouseHistory[0]);\n  }\n\n  handleActions() {\n    return () => {\n      if (this.selectedAction !== 'place') this.continuousAction();\n    };\n  }\n\n  clickAction() {\n    if (this.selectedAction === 'place') {\n      this.state.addParticle(this.actions.place[this.particleType](this.mouse));\n    }\n  }\n\n  continuousAction() {\n    this.state.addParticle(\n      this.actions[this.selectedAction][this.particleType](\n        this.mouse,\n        this.pointer\n      )\n    );\n  }\n\n  addEvents() {\n    const option = document.getElementById('option-buttons');\n    const particleType = document.getElementById('particle-type-buttons');\n    const canvas = document.querySelector('canvas');\n\n    option.onclick = this.selectAction();\n    option.ontouchend = this.selectAction();\n\n    particleType.onclick = this.selectMode();\n    particleType.ontouchend = this.selectMode();\n\n    canvas.onmousedown = this.mouseDown();\n    canvas.ontouchstart = this.mouseDown();\n\n    canvas.onmouseup = this.mouseUp();\n    canvas.ontouchend = this.mouseUp();\n\n    document.onmousemove = this.mouseMove();\n    document.addEventListener('touchmove', this.mouseMove(), {\n      passive: false\n    });\n  }\n\n  mouseDown() {\n    return e => {\n      const x = e.touches ? e.touches[0].clientX : e.clientX;\n      const y = e.touches ? e.touches[0].clientY : e.clientY;\n\n      this.mouse.moveTo(x / window.innerWidth, y / window.innerHeight);\n      this.pressing = true;\n\n      // clear previous interval in case mouseup occurred off of window\n      window.clearInterval(this.asyncActions);\n      this.asyncActions = window.setInterval(\n        this.handleActions(),\n        this.msPerAction\n      );\n    };\n  }\n\n  mouseMove() {\n    return e => {\n      e.preventDefault();\n      e.stopPropagation();\n      const x = e.touches ? e.touches[0].clientX : e.clientX;\n      const y = e.touches ? e.touches[0].clientY : e.clientY;\n\n      this.mouseHistory.shift();\n      this.mouseHistory.push(Vector.clone(this.mouse));\n      this.mouse.moveTo(x / window.innerWidth, y / window.innerHeight);\n    };\n  }\n\n  mouseUp() {\n    return () => {\n      this.clickAction();\n      window.clearInterval(this.asyncActions);\n    };\n  }\n\n  selectMode() {\n    return e => {\n      if (this.particleType !== e.target.id) {\n        this.state.reset();\n        this.particleType = e.target.id;\n      }\n      this.state.needsCleaning = this.particleType === 'stars';\n    };\n  }\n\n  selectAction() {\n    return e => {\n      switch (e.target.id) {\n        case 'reset':\n          this.state.reset();\n          break;\n        default:\n          this.selectedAction = e.target.id;\n      }\n    };\n  }\n}\n\nexport default Client;\n","import {\n  directionToColor,\n  speedToHSL,\n  sizeToRGBA\n} from './util/color_generators';\n\nclass Display {\n  constructor(state, client) {\n    this.particles = state.particles;\n    this.client = client;\n\n    this.ctx = document.querySelector('canvas').getContext('2d');\n\n    this.resize()();\n    this.reset();\n\n    window.onresize = this.resize();\n  }\n\n  get scale() {\n    return Math.min(this.width, this.height);\n  }\n\n  render() {\n    this.reset();\n    this.mouse(this.client.mouse);\n    this.renderParticles();\n  }\n\n  renderParticles() {\n    this[this.client.particleType]();\n  }\n\n  stars() {\n    const nParticles = this.particles.length;\n\n    for (let i = 0; i < nParticles; i += 1) {\n      const particle = this.particles[i];\n      if (particle.visualSize(this.scale) < 1) {\n        this.ctx.fillStyle = 'SandyBrown';\n        this.dot(particle);\n      } else {\n        this.star(particle);\n      }\n    }\n  }\n\n  dots() {\n    this.ctx.fillStyle = 'white';\n\n    const nParticles = this.particles.length;\n    for (let i = 0; i < nParticles; i += 1) this.dot(this.particles[i]);\n  }\n\n  automata() {\n    const nParticles = this.particles.length;\n    for (let i = 0; i < nParticles; i += 1) this.automaton(this.particles[i]);\n  }\n\n  gases() {\n    const nParticles = this.particles.length;\n    for (let i = 0; i < nParticles; i += 1) this.gas(this.particles[i]);\n  }\n\n  networks() {\n    this.ctx.beginPath();\n\n    this.ctx.lineWidth = 0.3;\n    this.ctx.strokeStyle = 'rgba(255,255,255,0.5)';\n\n    const nParticles = this.particles.length;\n\n    for (let i = 0; i < nParticles; i += 1) {\n      const particle = this.particles[i];\n      const fromX = particle.pos.x * this.width;\n      const fromY = particle.pos.y * this.height;\n      this.ctx.fillRect(fromX, fromY, 1, 1);\n\n      const nAdjacentParticles = particle.nearby.length;\n      for (let j = 0; j < nAdjacentParticles; j += 1) {\n        const toX = particle.nearby[j].x * this.width;\n        const toY = particle.nearby[j].y * this.height;\n\n        this.ctx.moveTo(fromX, fromY);\n        this.ctx.lineTo(toX, toY);\n      }\n      particle.nearby.length = 0;\n    }\n    this.ctx.stroke();\n\n    this.ctx.closePath();\n  }\n\n  resize() {\n    return () => {\n      this.width = window.innerWidth;\n      this.height = window.innerHeight;\n\n      this.client.displayWidth = this.width;\n      this.client.displayHeight = this.height;\n\n      this.ctx.canvas.width = this.width;\n      this.ctx.canvas.height = this.height;\n    };\n  }\n\n  reset() {\n    this.ctx.clearRect(0, 0, this.width, this.height);\n    this.ctx.fillStyle = 'white';\n    this.ctx.strokeStyle = 'white';\n    this.ctx.shadowBlur = 0;\n    this.ctx.shadowColor = 'rgba(0, 0, 0, 0)';\n    this.ctx.globalCompositeOperation = 'screen';\n  }\n\n  mouse({ x, y }) {\n    this.ctx.beginPath();\n\n    this.ctx.lineWidth = 1.5;\n    this.strokeStyle = 'rgba(255,255,255,0.2)';\n    this.ctx.arc(\n      x * this.width,\n      y * this.height,\n      0.008 * this.scale,\n      0,\n      2 * Math.PI,\n      false\n    );\n    this.ctx.stroke();\n\n    this.ctx.closePath();\n  }\n\n  star(particle) {\n    const { pos } = particle;\n    const size = particle.visualSize(this.scale);\n    const color = sizeToRGBA(particle.size());\n\n    this.ctx.fillStyle = color;\n    this.ctx.shadowColor = color;\n    this.ctx.shadowBlur = 2 * size;\n\n    this.circle(pos.x * this.width, pos.y * this.height, size);\n  }\n\n  circle(x, y, radius) {\n    this.ctx.beginPath();\n    this.ctx.arc(x, y, radius, 0, 2 * Math.PI, false);\n    this.ctx.fill();\n  }\n\n  automaton(particle) {\n    const { pos, vel } = particle;\n    const size = particle.visualSize(this.scale);\n    this.ctx.fillStyle = directionToColor(vel);\n\n    this.circle(pos.x * this.width, pos.y * this.height, size);\n  }\n\n  gas(particle) {\n    const { pos, vel } = particle;\n    const size = particle.visualSize(this.scale);\n    this.ctx.fillStyle = speedToHSL(vel);\n\n    this.circle(pos.x * this.width, pos.y * this.height, size);\n  }\n\n  dot({ pos }) {\n    this.ctx.fillRect(pos.x * this.width, pos.y * this.height, 1, 1);\n  }\n\n  line(from, to) {\n    this.ctx.beginPath();\n    this.ctx.moveTo(from.x * this.width, from.y * this.height);\n    this.ctx.lineTo(to.x * this.width, to.y * this.height);\n    this.ctx.stroke();\n    this.ctx.closePath();\n  }\n\n  subLine(from, to) {\n    this.ctx.moveTo(from.x * this.width, from.y * this.height);\n    this.ctx.lineTo(to.x * this.width, to.y * this.height);\n  }\n}\n\nexport default Display;\n","export const sizeToRGBA = (size, alpha = 1) => {\n  const rC = -(18 ** 4);\n  const gC = -(15 ** 4);\n  const bC = -(11 ** 4);\n\n  const rExp = (size - 0.045) ** 4;\n  const gExp = (size - 0.07) ** 4;\n  const bExp = (size - 0.11) ** 4;\n\n  const red = 255 * (rC * rExp + 1);\n  const green = 255 * (gC * gExp + 1);\n  const blue = 255 * (bC * bExp + 1);\n\n  return `rgba(${red},${green},${blue},${alpha})`;\n};\n\nexport const speedToHSL = vel => {\n  const speed = vel.dot(vel);\n  const hue = Math.min(120 * (speed * 1.5e4) + 240, 360);\n  return `hsl(${hue},100%,50%)`;\n};\n\nexport const directionToColor = ({ x }) => {\n  if (x > 0) return 'blue';\n  if (x < 0) return 'green';\n  return 'grey';\n};\n"],"sourceRoot":""}